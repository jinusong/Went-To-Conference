# NAVER TECH CONCERT: iOS



### 네이버 지도 밑그림을 그리는 SDK 개발자가 하는일

------

###### 새로운 네이버지도를 만들기 위한 벡터맵 SDK 개발기와 네이버지도5 런칭, 네이버클라우드플랫폼에 모바일 지도 SDK를 출시하기까지의 여정. SDK 개발자가 하는일을 알려드립니다.

- SDK란
  - 범용적으로 사용할 수 있는 부분을 모아서 발매를 한 것 -> SDK
  - 현재 네이버지도 ver.5 까지 왔어요
- ver.5에서 달라진 것은?
  - 래스터 -> 벡터
    - 비트맵 타일을 격자로 배치 했었음
    - 서버가 벡터 데이터를 온디맨드로 생성
    - 클라이언트가 데이터와 스타일을 조합해 실시간 렌더링
    - 항공영상등은 아직 비트맵 사용중
  - Objective-C -> Swift
  - 영어 -> 영어, 일본어, 중국어
  - 실시간 업데이트 미지원 -> 지원
  - 각종 엔진 내재화
    - 외부 엔진 사용하지 않고 개발
    - 모듈형 설계
  - 사용성 개편
    - 앱 플로우 개선
    - 검색창 통합
    - 시인성, 가독성이 좋은 디자인
  - 업데이트를 했으나 반응이 좋지 않았음
- Ver.5에서 문제점
  - 너무 많은 UI/UX 변화
  - 새로운 엔진의 퀄리티 문제
    - 내부 엔지만 사용하다보니 불안한 부분이 있음
  - 일정에 맞춰서 개발하다보니 QA 부족
  - 지속적인 개선과 업데이트로 사용자들이 돌아오도록 함
- NaverNap Mobile SDK
  - OpenGl ES 사용한 풀 벡터 지도 렌더링 엔진
  - 오픈소스 최대한 활용
    - WebBox 사용
    - 지도 엔진만 볼 때는 충분히 개발할 수 있다
    - 지도 엔진은 독자적으로 동작할 수가 없음
    - 데이터, 서버, 디자인 등 다양한 분야의 플랫폼과 운영 도구가 필요해 오픈소스 사용
    - 잘 되어있는 소스는 코드만 사용. 나머지는 직접 개발
    - 굳이 건드리지 않을 것은 건드리지 않고 필요한 것만 사용
  - 네이버 지도, AWAY, AKI, Clova에도 적용
  - 네이버 클라우드 플랫폼을 통해 오픈 API 공개
- 개선 사항
  - 비트맵에서는 줌 인, 줌 아웃, 회전을 할 때 퀄리티가 떨어졌지만 벡터 이미지를 사용하면서 개선
  - 이미지를 가져오는 것이 아니기 때문에 데이터 사용량을 대폭 줄일 수 있었음
    - 이전: 일반지도 + 지적편집도 + 자전거 + 심볼 등 여러 타일을 겹쳐서 지도를 완성
      - 레이어를 토글링 or 교통정보가 바뀌면 이미지를 다시 로드해야 함
      - 전체 타일을 프리렌더링 하는 데에 1주일 소요
    - 현재: 이전 다시 로드해야 하는 부분이 사라짐
- 집중한 부분
  - 여러 요구 사항에 맞춰 개발하기
  - 성능
    - 최신 폰들과는 다르게 구형 기기들에서는 3D 렌더링 속도가 느린 이슈가 있었음
      - 너무 많은 메모리 사용
        - 앱에서 올리는 오버레이가 사용하는 비트맵
      - CPU
        - 심볼들이 동적으로 배치가 되기 때문에 줌 인, 줌 아웃, 회전을 할 때 계속 계산해야 함
    - 프로파일링 도구를 사용
      - Xcode Instruments
  - API 디자인 & 문서화
    - API 문서
      - 스레드, 널 가능성, 단위 애너테이션
      - 값 범위, 예외
      - 적절한 @link, @see
    - 개발 가이드
      - 텍스트만 100p+
      - 예제 코드, 스크린샷
      - API 레퍼런스로의 링크
- 사용 기업
  - 타다, 망고 플레이트, 리멤버, 메쉬코리아 등



### 들숨에 협업 날숨에 클린코드

------

###### 기본도 기초도 없던 개발자가 프로의 세계에 발을 들이게 된 과정과 고민을 공유합니다. 듣기엔 좋지만 말하기는 껄끄러운 클린코드라는 것은 도대체 무엇이고 어떻게 실현할 수 있는가. 우리 모두가 맞닥뜨릴 수 있는 올챙이 시절 이야기. 맞춤법/인덴트 수정부터 MVC 탈출기까지, 뱅크샐러드 iOS 팀에서 고민하는 협업, 우리가 5인 6각 마라톤을 달리는 방식에 대해 공유합니다.

- code convention
  - 같은 코드도 다르게 작성하는 개발자들을 보고 코드 리뷰를 할 때 들어가는 물리적 시간이 너무 많이 들어감
  - 뱅샐에서는?
    - 동일한 역할을 하는 구문끼리의 convention은 최대한 동일하게
    - Components, parameters 은 개별로 보기 쉽게, 하나의 line이 너무 길지 않게
  - 읽기 좋은 코드로 생산성을 극대화하기
  - [SwiftLint](https://github.com/realm/SwiftLint/blob/master/README_KR.md)
    - 좀 더 비즈니스 로직에 집중할 수 있도록 해줌
- MVC 패턴 탈출하기
  - MVC 문제
    - 너무 방대한 viewcontroller
  - MVVM를 적용하자!
    - MVVM
      - view와 model간에 긴밀한 연결이 없다
      - view는 viewmodel을 가진다
      - 느슨한 종속성으로 분리해 unit test를 하는것이 가능
      - [BringMyOwnBeer](https://github.com/fimuxd/BringMyOwnBeer-) -> MVVM 예제 코드
  - 뱅샐에서는?
    - View
      - 
    - ViewBindable
      - view에서 발생하는 모든 이벤트, 액션 전달
    - ViewModel
      - View의 분신
      - ViewBindable의 구현체
    - Model
      - Network 등 연결
      - Buisness Logic만 전담
    - 목표
      - 각자의 일은 각자가 하기
- TDD 도전
  - API 명세에 따른 dummy data를 너허 테스트를 함
- 경쟁에서 최고의 무기는 '협업'이라고 믿습니다.
- 클린 코드는 협업을 위한 코드다



### 쉽고 재미있는 iOS 디버깅 - LLDB Command

------

###### Xcode에서 LLDB를 통해 디버깅을 지원하고 있습니다. 하지만 많은 명령어들이 숨겨져있고 접하기 쉽지 않기 때문에 디버깅시 많은 시간을 낭비하곤 합니다. LLDB의 명령어를 좀 더 깊이 살펴보면서 문제를 좀 더 쉽게 찾고 해결할 수 있도록 합니다.

- [LLDB](lldb.llvm.org)란?

  - Xcode 기본 컴파일러는 LLVM
    - LLVM에서 지원하는 디버거

- Execution Command

  - thread list: 모든 쓰레드 확인하기
  - thread select (num): 특정 쓰레드로 이동
  - thread backtrace: 쓰레드의 모든 프레임을 출력
  - thread backtrace all: 모든 쓰레드의 모든 프레임을 출력
  - thread backtrace -c (num): num 만큼 프레임 출력
  - frame select (num): frame index 이동
  - frame info: 해당 프레임 정보 출력
  - up/down (num): 프레임 위 아래로 num만큼 이동
  - frame variable [변수명]: 해당 프레임의 변수 값을 출력
  - target variable: 해당 소스의 모든 글로벌 소스 출력
  - thread step-over: 현재 소스 수준의 다음 코드 진행
  - thread step-in: 현재 frame에서 소스 수준의 한 단계 밑으로 내려감
  - thread step-out: 현재 frame을 진행 후 벗어남
  - thread until (num): num 줄 전까지 실행
  - Thread jump —line (num): num 라인으로 이동

- Evaluating Expression

  - LLDB의 기본적인 언어 설정은 없음

    - 어디에서 멈춰있는지에 따라 사용할 수 있는 언어가 변경
    - Pause 상태에서 Swift를 사용하려면 언어 변경 필요

  - p, po, fr v(frame variable) 명령어를 이용

  - 변수 설정하기

    ```swift
    setting set target.language swift
    expression var $foo = 5
    expr print($foo)
    e $foo += 1
    e print(foo)
    ```

  - po: 코드를 실행하고 debugDescription 또는 description을 출력

    - 실행 속도가 느려 지양하는게 좋다

  - p: 코드를 실행하며 LLDB formatter를 사용해 출력

    - po보다는 간결하고 속도도 빨라짐

  - fr v: 코드를 실행하지 않고 LLDB formatter를 사용해 출력

    - po나 p보다는 훨씬 더 빠른 속도로 콘솔창에 값을 띄울 수 있다.

- 프레임을 보여주는 창에서 오른쪽 하단에 제일 왼쪽 버튼을 비활성화 하면 숨겨져있는 프레임 확인 가능

- [Chisel](https://github.com/facebook/chisel)이란?

  - iOS 디버깅을 위한 LLDB 명령어 모음

- 참고자료

  - advaced apple debugging & reverse programming



### ARKit, CoreML, Turi Create 삼형제

------

###### Notable Me라는 AR앱을 개발한 경험을 공유하고자 합니다. 애플의 총애를 받고 있는 ARKit을 잘 활용하는 법과 Core ML로 앱의 기능을 다채롭게 하는 팁을 방출합니다. 또한 Turi Create을 통해 머신러닝 초보라도 훌륭한 모델을 직접 만들수 있는 방법을 공유하고 NSML이라는 네이버의 ML 학습 플랫폼으로 훈련한 과정을 소개합니다. 덤으로 모바일 개발자와 ML 개발자의 생생한 협업 과정도 엿볼 수 있습니다.

- Image Tracking
  - ARKit를 사용해 asset에 tracking할 이미지 넣기
- Face Detection
  - AVMetadataFaceObject + MLKit 사용
  - AVMetadataFaceObject
    - 얼굴에 빨간 테두리를 보여줌
  - MLKit
    - 얼굴을 분석해줌
- Convert Coordinate
  - UIKit은 왼쪽 상단, Core Graphics는 왼쪽 하단이 (0, 0)이여서 변환을 해주어야 했음
- Style Transfer
  - 네이버 사내 시스템 사용
    - Artistic Style Transfer(사진 질감 바꾸기)
    - Create ML, Turi Create 차이점
      - Create ML
        - Swift
        - MacOS
        - 맥 + eGPU 사용해 GPU 가속
        - Full GUI tool 제공
      - Turi Create
        - Python
        - MacOS, Linux, Window
        - Linux + Nvidia GPU
        - Style Transfer Model 제공
        - 오픈소스
    - 일반적인 모델 학습
      - 데이터준비
        - 입력 데이터와 모델이 출력해야하는 정답 데이터 짝을 준비
      - 모델 훈련
        - 오차를 최소화 하도록 모델 내부 파라미터 갱신
      - 모델 평가
        - 테스트 데이터를 넣어 성능 지표 만들기
    - Style Transfer 모델 학습
      - 데이터 준비
        - 모델이 학습해야하는 스타일 이미지와 콘텐트 이미지 세트를 준비
      - 모델 훈련
        - 콘텐트 이미지와의 시맨틱 오차를 최소화
        - 스타일 이미지와의 스타일 오차를 최소화하도록 모델 내부 파라미터 갱신
      - 모델 평가
        - 결과가 마음에 드는 effect 인지는 눈으로 확인해야만 알 수 있음
    - 하이퍼 파라미터란?
      - 학습이 시작되기전에 설정하는 값
        - 최상의 모델학습결과를 얻을 수 있는 파라미터의 값을 찾아야 함
    - 각 파라미터 조합으로 학습을 시킬 때 로컬에서는 한번에 하나의 조합 밖에 학습할 수 없음
      - 사내 MLaaS인 NSML을 사용
    - ML을 잘 모르는데 스타일 트랜스퍼 모델 사용하고 싶으면 Turi Create
      - 필요 모델이 Create ML에서 제공되는 모델이면 CreateML을 사용하는 것이 맞다
    - 스타일 트랜스퍼 모델은 퍼포먼스 척도로는 훈련결과를 평가하기 힘들다
      - 눈으로 직접 결과물을 봐야함
      - 하이퍼 파라미터 튜닝을 할 때 훈련결과를 잘 비교할 수 있는 방법이 필요
    - MLaaS를 사용해 실험을 병렬로 수행하면 생산성이 100배 이상 차이 날 수 있음
      - Google Cloud ML Engine, AWS SageMaker, Naver NSML
    - 스타일 이미지의 사이즈가 너무 크면 제대로 안될 수 있음
- ARKit Overheating
  - ARKit를 3분 이상 키면 기기가 매우 뜨거워져 기기의 발열을 체크하고 알림 메시지를 띄워주기
    - systemPressureState에 Observar를 달아놓고 온도를 체크
  - thermalStateDidChangeNotification
- Memory Budget
  - stackoverflow에 찾아보면 기기별 memory 사용량이 나와있음
- Anchoring
  - ARAnchor
    - 위치를 represent하는 것
  - SCNNode
    - ARAnchor와 1대1 매칭



### 사용자 경험을 높이는 애니메이션 만들기

------

###### 앱의 사용자 경험을 높이는 애니메이션을 구현하기 위하여 알아두면 유용한 이론과 디자인 가이드라인, API에 대하여 살펴봅니다.

- 왜 애니메이션이 필요할까?

  - 화면 구현하기도 바쁜데, 굳이 애니메이션까지??

    - 무언가 유용한 기능을 하게 하기 위해 넣는 것

    - UI 요소들은 컨텐츠를 이해하기 쉽게 만들기 위한 요소. 애니메이션 또한 그렇다

  - 애니메이션 기능(애플이 정의)

    - 중요한 컨텐츠 강조
      - 컨텐츠 상에 중요한 변화가 생겻을 때 발동됨
      - 한 번 재생되면 멈추지 않고 쭉 재생
      - Ex) 앱 오른쪽 위에 뱃지, mac에서 독바에서 통통 튀는 애니메이션
      - UIView.animate API 사용
    - 컨텐츠의 맥락 유지(어떤 식으로 변화하는지)
      - 트랜지션 효과
      - UIView.transition API 사용
      - UIViewcontroller 간의 애니메이션은 더욱 복잡
        - UIViewControllerAnimatedTransitioning + UIViewControllerTransitinoingDelegate
    - 유저 입력에 대한 컨텐츠의 반응
      - 사용자 제스처에 따라 점진적으로 재생됨
      - 제스처의 시작, 변화, 종료에 대한 애니메이션을 각각 정해주어야 함
      - Touches 로 시작되는 메소드를 사용하면 쉽다
      - UIGestureRecognizer를 사용하면 커스텀한 제스처 애니메이션 사용 가능

- 어떻게 애니메이션을 구현할까?
  - 애니메이션 구현은 어려워요 ㅠ
    - 시간 요소가 들어가서 복잡함
    - 디버깅의 어려움
    - API의 어려움과 생소한 개념
    - 스펙 분석의 어려움
  - 애니메이션 요소 파악하기
    - 복잡한 애니메이션의 스펙을 빠르게 분석 가능
    - 어떤 API를 사용할 지 신속히 판단 가능
    - 새로운 API를 이해할 때도 도움이 됨
- 애니메이션이란?
  - 특정 이벤트가 발생했을 때 UI 요소를 시간에 따라 변화시키는 것
- 애니메이션 3요소
  - 트리거: 어떻게 시작
    - 단발성: 한 번 발동되면 처음부터 끝까지 쭉 지속되는 것(Fire-and-Forget)
      - 논스톱 애니메이션이므로 사전에 애니메이션 값을 잘 정의해놓아야 함
      - UIView.animate API 사용
    - 연속성: 사용자의 제스처나 데이터의 변화에 의해 애니메이션이 점진적으로 실행됨
      - UIGestureRecognizer와 연관이 깊다
      - Pan, Rotate, Pinch 등
  - 타겟: 무엇을 변화
    - 시간에 따라 변화할 수 있는 시각적 속성은 전부 target이 될 수 있다
    - UIView.transition을 사용
    - CALayer
      - 조금 더 커스텀하게 애니메이션 설정할 때
      - CABasicAnimation 사용
      - UIView보다 성능에 이점
    - NSLayoutConstraint
      - Auto Layout 관련된 애니메이션
    - UIBeizerPath
      - 벡터 기반의 선을 변화시킬 때
  - 타임: 어떤 빠르기로 얼마나 변화
    - duration
      - 얼마나 오랫동안 애니메이션을 재생할 것인가
      - 간단한 애니메이션은 0.3~0.5초 사이가 적당
    - curve
      - 커브 값은 가능한 실제 세계의 움직임과 비슷하게
      - [커스텀한 커브값 만들기](https://cubic-bezier.com)
        - CAMediaTimingFunction(controlpoints: (복사한 값))
- 애니메이션 연습하기
  - [Dribble](https://dribble.com)에서 좋은 애니메이션 찾아서 카피 해보기
  - 가능한 기본 API를 활용해서 구현해보기
  - 좋은 애니메이션 발견하면 Trigger, Target, Time 분석해보기



### [패널톡] iOS 개발자의 성장 루트

------

- 취업? 창업? 자영업? 어느 쪽으로 갈지 진로가 고민입니다.
  - 취업을 할 수도 있고 공부를 할 수도 있고, 창업 혹은 개인 개발자가 될지
    - 창업과 개인 개발자
      - 개발을 좋아하면 창업은 하지 않았으면.
      - 이 세상에 비전이 있어서 창업을 하는 것이 아니라 개발자의 커리어를 쌓기 위함이라고 하면 그건 쫌 아닌 것 같다.
- 어떤 회사에 취업하는 것이 개발자 커리어 관리 측면에서 좋을까요?
  - SI 회사라고 꼭 나쁜것이 아니다
  - 그 회사가 내가 공부하려는 것을 지원해줄 수 있는지가 중요
  - 일단은 면접도 많이 보고 개발자들도 많이 봐야 안목이 늘어나는 것 같다.
- 어떻게 하면 원하는 회사에 갈 수 있을까요?
  - 일단 개인이 공부가 많이 되어 있어야 함
    - 공부를 많이 해야되는 거죠.
  - Hackday?
    - 네이버 개발자와 대학생들이 1박2일 동안 진행하는 해커톤?
  - 부스트캠프 + 패스트캠퍼스
  - 이력서를 작성할 때는 최대한 돋보이게
- 개발 방법을 공부하는 법
  - 갖춰야 할 능력: 공부를 하는 방법
    - 일단 한 번 만들어봐라!
      - iOS 처음 할 때 iOS 시작하려면 어떻게 해야되냐라고 물어보면 swift 공부 하고 바로 프로젝트를 진행하라고 함
      - 이런 식으로 공부하면 순서가 없기 때문에 정리하는 시간이 필요함
    - 처음부터 알바?
      - 자신이 압박이 없으면 공부를 하지 않을 것이라는 것을 알아서 알바를 바로 따와서 책임을 져야 하기 때문에 그렇게 공부함
    - 책보다는 인터넷
      - 인터넷에서 찾은 코드를 붙이고 사용한 후 끝이 아니라 어떻게 동작하는 것인지 이해하고 파악해야 함
      - 그냥 가져다 쓰면 그런게 있다라고만 알 수 있지 다음에 또 찾아야 함
      - 커뮤니티 활동 + 스터디
      - 언어나 플랫폼에 제한을 두지 않고 여러 가지를 찾아다니면서 새로운 시각을 여는 것이 필요
    - 책으로 시작해서 책으로 끝내기
      - 책을 보면 유명한 개발자분들이 책을 쓰기 때문에 책에서 배울 수 있는것이 많다.
      - 문법서 -> 튜토리얼 책
      - 금전적인 문제로 책을 많이 사기가 힘들다.
        - 출판사들이 책 리뷰어를 지원해서 열심히 읽으면서 지식을 습득하려고 노력을 했다.
      - 나중에는 원서를 읽게 됨
        - 출판사에 번역을 해달라고 함
        - 시험을 보고 출판사에서 번역 의뢰를 받고 번역을 시작함
    - Apple 문서만 보기
      - 2001년에 시작하셔서 아무것도 없어서 애플 문서만 보는것이 습관이 되어버렸어요
      - 인터넷에 있는 수많은 것들에는 수많은 오류가 있기 때문에 가장 정확하고 옳은 방법은 apple 문서이다
      - 어떻게 공부를 하더라도 최종적으로 apple 문서를 확인을 해야한다
    - 블로그, 동영상 만들기 등 설명하기
      - 설명을 하는 것은 그 누구에게 물어보더라도 최고의 공부 방법일 것이다.
- ReactNative / Flutter 등?
  - 자신의 능력에 따라 효율이 다르다
    - js를 하는데 ReactNative를 시작한다면 빠르지만 결국은 자신이 생각한 효율은 나오지 않음
  - iOS, 안드로이드 다 할 수 있다고 정답은 아니다
    - 그렇다고 둘 다 배우는 것도 정답은 아님
    - 자신의 능력에 따라 적절한 것을 고르는 것이 옳다
- iOS 개발자의 미래?
  - 이 걱정을 하기 전에 공부를 하는 방법을 공부하는 것이 먼저
  - 공부 하는 방법을 알면 apple이 망해도 다른 것을 하면 됨
    - 노키아, 야후 등이 망한 것처럼 애플도 어떻게 될지 모름
- iOS 개발자로 개발자 커리어를 시작한다면?
  - 모바일 + 데스크탑을 자유롭게 왔다갔다할 수 있어 좋다
  - iOS 개발자를 뽑기가 쉽지가 않다
    - iOS 개발자를 뽑으려고 하면 대부분 안드로이드 경험이 많고 iOS 개발 경험이 없다



### Naver Engineering Culture Booth_FAQ

------

- 네이버는 네이버 앱만?
  - 웨일, 파파고, 웹툰, 라인….등등 많아요
- 네이버는 세계 9등 혁신 회사
- 네이버 개발자 복지?
  - 최고의 동료와 전문가
  - 수많은 사용자에게서 오는 실시간 피드백
  - 1초마다 생겨나는 데이터
- 개발자 채용 계획
  - 8월말 신입 개발자 공채
